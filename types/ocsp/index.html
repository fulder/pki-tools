<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://pki-tools.fulder.dev/types/ocsp/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>OCSP - PKI Tools</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "OCSP";
        var mkdocs_page_input_path = "types/ocsp.md";
        var mkdocs_page_url = "/types/ocsp/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> PKI Tools
        </a>
        <div class="version">
          latest
        </div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Functions</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../funcs/check_revocation/">Checking Revocation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Types</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../certificate/">Certificate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../crl/">CertificateRevocationList</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csr/">CertificateSigningRequest</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../certificates/">Certificates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../chain/">Chain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enums/">Enums</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../name/">Name</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">OCSP</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../extensions/">Extensions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../key_pair/">KeyPair</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exceptions/">Exceptions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../crypto_parser/">CryptoParser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../signature_algorithm/">SignatureAlgorithm</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">PKI Tools</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Types</li>
      <li class="breadcrumb-item active">OCSP</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/fulder/pki-tools/tree/main/docs/types/ocsp.md">Edit on fulder/pki-tools</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="pki_tools.types.ocsp"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="pki_tools.types.ocsp.OCSPRequest" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OCSPRequest</span>


<a href="#pki_tools.types.ocsp.OCSPRequest" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="InitCryptoParser (pki_tools.types.crypto_parser.InitCryptoParser)" href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser">InitCryptoParser</a></code></p>


        <p>Represents an OCSP request.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>hash_algorithm</code></b>
                  (<code><a class="autorefs autorefs-internal" title="HashAlgorithm (pki_tools.types.signature_algorithm.HashAlgorithm)" href="../signature_algorithm/#pki_tools.types.signature_algorithm.HashAlgorithm">HashAlgorithm</a></code>)
              –
              <div class="doc-md-description">
                <p>The hash algorithm.</p>
              </div>
            </li>
            <li>
              <b><code>serial_number</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The serial number.</p>
              </div>
            </li>
            <li>
              <b><code>extensions</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="Extensions (pki_tools.types.extensions.Extensions)" href="../extensions/#pki_tools.types.extensions.Extensions">Extensions</a>]</code>)
              –
              <div class="doc-md-description">
                <p>The extensions.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <h5 id="pki_tools.types.ocsp.OCSPRequest--examples">Examples<a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest--examples" title="Permanent link">&para;</a></h5>
<h6 id="pki_tools.types.ocsp.OCSPRequest--create-ocsp-request">Create OCSP Request<a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest--create-ocsp-request" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>cert</code></summary>
<pre><code>import datetime

from pki_tools import SHA512, Validity, Name, Certificate, RSAKeyPair

cert = Certificate(
    subject=Name(cn=[&quot;Cert CN&quot;]),
    issuer=Name(cn=[&quot;Cert CN&quot;]),
    validity=Validity(
        not_before=datetime.datetime.today() - datetime.timedelta(days=1),
        not_after=datetime.datetime.today() + datetime.timedelta(days=1),
    ),
)

cert.sign(RSAKeyPair.generate(), SHA512)
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPRequest

req = OCSPRequest(
    hash_algorithm=SHA512.algorithm, serial_number=cert.serial_number
)

req.create(cert, cert)

print(req.pem_string)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Serial Number: '1419969360'
algorithm: SHA512


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPRequest--initcryptoparserfrom_file"><a class="autorefs autorefs-internal" title="from_file


  
      classmethod
  " href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.from_file">InitCryptoParser.from_file</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest--initcryptoparserfrom_file" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>req.pem</code></summary>
<pre><code>-----BEGIN OCSP REQUEST-----
MIG1MIGyMIGvMIGsMIGpMA0GCWCGSAFlAwQCAwUABEB6/1zxTH1hbenJdMcinslv
asdow/1VPLNqVdaDuD7gesgzTv6pMU1PVc1OwtvuncM+afDNXnWEWgiAoFXSDfFQ
BEDxuEQwiwNp5nD/Qc/BXaFEWVE7EPBp9WA/65jQSZcEmCO665C+92G+BPaoI/EE
Fl+npz50sv7HrqDeJrU+WZCFAhRPA+Kc1W3fBuNfGzu5tzF2tjo7Yw==
-----END OCSP REQUEST-----
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPRequest

req = OCSPRequest.from_file(&quot;req.pem&quot;)

print(req)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Extensions: {}
Serial Number: '451096913875044778748831451124639911061942319971'
algorithm: SHA512


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPRequest--initcryptoparserfrom_pem_string"><a class="autorefs autorefs-internal" title="from_pem_string


  
      classmethod
  " href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.from_pem_string">InitCryptoParser.from_pem_string</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest--initcryptoparserfrom_pem_string" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>pem</code></summary>
<pre><code>pem = &quot;&quot;&quot;
-----BEGIN OCSP REQUEST-----
MIG1MIGyMIGvMIGsMIGpMA0GCWCGSAFlAwQCAwUABEB6/1zxTH1hbenJdMcinslv
asdow/1VPLNqVdaDuD7gesgzTv6pMU1PVc1OwtvuncM+afDNXnWEWgiAoFXSDfFQ
BEDxuEQwiwNp5nD/Qc/BXaFEWVE7EPBp9WA/65jQSZcEmCO665C+92G+BPaoI/EE
Fl+npz50sv7HrqDeJrU+WZCFAhRPA+Kc1W3fBuNfGzu5tzF2tjo7Yw==
-----END OCSP REQUEST-----
&quot;&quot;&quot;
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPRequest

req = OCSPRequest.from_pem_string(pem)

print(req)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Extensions: {}
Serial Number: '451096913875044778748831451124639911061942319971'
algorithm: SHA512


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPRequest--initcryptoparserto_file"><a class="autorefs autorefs-internal" title="to_file" href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.to_file">InitCryptoParser.to_file</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest--initcryptoparserto_file" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>pem</code></summary>
<pre><code>pem = &quot;&quot;&quot;
-----BEGIN OCSP REQUEST-----
MIG1MIGyMIGvMIGsMIGpMA0GCWCGSAFlAwQCAwUABEB6/1zxTH1hbenJdMcinslv
asdow/1VPLNqVdaDuD7gesgzTv6pMU1PVc1OwtvuncM+afDNXnWEWgiAoFXSDfFQ
BEDnCmRUwFymLe1CkhH/iY+y03tK/R5ACKvX2BSe/sWnXrHtW4whiQowmpxQPlvN
od+22kNsyj67c0Rb/m76j/gSAhRX1AhPCGDVeO5pEcsQ+BDt4x5LMQ==
-----END OCSP REQUEST-----
&quot;&quot;&quot;
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPRequest

req = OCSPRequest.from_pem_string(pem)

req.to_file(&quot;out_req.pem&quot;)

</code></pre>
<details class="note">
<summary><code>out_req.pem</code></summary>
<pre><code>-----BEGIN OCSP REQUEST-----
MIG1MIGyMIGvMIGsMIGpMA0GCWCGSAFlAwQCAwUABEB6/1zxTH1hbenJdMcinslv
asdow/1VPLNqVdaDuD7gesgzTv6pMU1PVc1OwtvuncM+afDNXnWEWgiAoFXSDfFQ
BEDnCmRUwFymLe1CkhH/iY+y03tK/R5ACKvX2BSe/sWnXrHtW4whiQowmpxQPlvN
od+22kNsyj67c0Rb/m76j/gSAhRX1AhPCGDVeO5pEcsQ+BDt4x5LMQ==
-----END OCSP REQUEST-----

</code></pre>
</details>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPRequest.pem_bytes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">pem_bytes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPRequest.pem_bytes" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">pem_bytes: <span title="bytes">bytes</span></code></pre>

    <div class="doc doc-contents ">

        <p>Returns the PEM bytes of the object</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="bytes">bytes</span></code>
              –
              <div class="doc-md-description">
                <p>The PEM bytes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPRequest.request_path" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">request_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPRequest.request_path" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">request_path: <span title="str">str</span></code></pre>

    <div class="doc doc-contents ">

        <p>The request path of the OCSP Response.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              –
              <div class="doc-md-description">
                <p>The request path.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="pki_tools.types.ocsp.OCSPRequest.create" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create</span>


<a href="#pki_tools.types.ocsp.OCSPRequest.create" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">create(cert: <a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a>, issuer_cert: <a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a>)</code></pre>

    <div class="doc doc-contents ">

        <p>Creates an OCSP request.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>cert</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a></code>)
              –
              <div class="doc-md-description">
                <p>The certificate.</p>
              </div>
            </li>
            <li>
              <b><code>issuer_cert</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a></code>)
              –
              <div class="doc-md-description">
                <p>The issuer of the OCSP Response.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pki_tools.types.ocsp.OCSPRequest.from_cryptography" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_cryptography</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPRequest.from_cryptography" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">from_cryptography(crypto_obj: <span title="cryptography.x509.ocsp">ocsp</span>.<a class="autorefs autorefs-external" title="cryptography.x509.ocsp.OCSPRequest" href="https://cryptography.io/en/latest/x509/ocsp/#cryptography.x509.ocsp.OCSPRequest">OCSPRequest</a>) -&gt; <a class="autorefs autorefs-internal" title="OCSPRequest (pki_tools.types.ocsp.OCSPRequest)" href="#pki_tools.types.ocsp.OCSPRequest">OCSPRequest</a></code></pre>

    <div class="doc doc-contents ">

        <p>Constructs an OCSPRequest object from a cryptography OCSPRequest
object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>crypto_obj</code></b>
                  (<code><span title="cryptography.x509.ocsp">ocsp</span>.<a class="autorefs autorefs-external" title="cryptography.x509.ocsp.OCSPRequest" href="https://cryptography.io/en/latest/x509/ocsp/#cryptography.x509.ocsp.OCSPRequest">OCSPRequest</a></code>)
              –
              <div class="doc-md-description">
                <p>The cryptography OCSPRequest object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><a class="autorefs autorefs-internal" title="OCSPRequest (pki_tools.types.ocsp.OCSPRequest)" href="#pki_tools.types.ocsp.OCSPRequest">OCSPRequest</a></code>
              –
              <div class="doc-md-description">
                <p>The constructed OCSPRequest object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <h6 id="pki_tools.types.ocsp.OCSPRequest.from_cryptography--example">Example<a class="headerlink" href="#pki_tools.types.ocsp.OCSPRequest.from_cryptography--example" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>crypto_ocsp_request</code></summary>
<pre><code>from cryptography.hazmat.primitives.hashes import SHA256
from cryptography.x509 import ocsp, load_pem_x509_certificate

pem_cert = b&quot;&quot;&quot;
-----BEGIN CERTIFICATE-----
MIICsDCCAZigAwIBAgIUJDBA6chIz7alIJGj//DNL7Pq0HowDQYJKoZIhvcNAQEN
BQAwEjEQMA4GA1UEAwwHQ2VydCBDTjAeFw0yNDAzMTYxMzQzNTdaFw0yNDAzMTcx
MzQzNTdaMBIxEDAOBgNVBAMMB0NlcnQgQ04wggEiMA0GCSqGSIb3DQEBAQUAA4IB
DwAwggEKAoIBAQDDtBdJp6oYQSIBuefvRphiau2GFGlPNvnyAm7DcVHLREiSSPX2
Ov8Krkg9/iqoZS3lcmEgj/BQMyySpJt+5Ggo60pbJBWHR86+jLBCwu687OAsfGtz
DQPN5xSWnC4K0OaUDm2doaGMcffzLL65ry/HV1XaRxxkK6HuZDt9VtyyrvSyXvMT
N0CuenLPx2b+t3owjg9wrCZghBsIQWkhCQiCN35UbEuZ3Wv3H1ezulNe0/r782NB
TXEmL6qGe/yx+//23vbmzIDar8UYEKrFNZ1yiugNWXLJKxwmxIyNtLr29MX5jrY+
yFxup5D0JTDyKRINq+dtzzLgxzPoOzMzEDZvAgMBAAEwDQYJKoZIhvcNAQENBQAD
ggEBADHeiK+JB6Z25afqGVSa1oIGEvCo8mi50/tcT+lH03Jt5x+bAKgPJGI8Gew/
0ko7JU3O8Sy3nTrVnLcgKSJiot6t7DMhWOSKTcuJTCOsr2WDgJQvF49yZfg+f5df
AWwXkraTwjJ0RoIHN/Kp0TZvgAlZhKkHFNnqT2laubjMIzeF6k/3o6HZCfBV83fu
YbzBK6rQjzFklxBN+ml2XX1aBMKYkqjbsfLpl7mAKUiZ58jxu6/FGTh6O8ffrr9z
iQBRwByulMBGxzitq/EUoTEeKvtiX5WFTetE19EE7Ojzy6c6qkNlwCjK49WF6smA
2IBk2TPLyVH4LeRc/XQi+Oj7ak0=
-----END CERTIFICATE-----
&quot;&quot;&quot;
cert = load_pem_x509_certificate(pem_cert)

builder = ocsp.OCSPRequestBuilder()
builder = builder.add_certificate(cert, cert, SHA256())
crypto_ocsp_request = builder.build()
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPRequest

ocsp_request = OCSPRequest.from_cryptography(crypto_ocsp_request)

print(ocsp_request)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Extensions: {}
Serial Number: '206599758257502475477849880650720292246800486522'
algorithm: SHA256


</code></pre>
</details>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="pki_tools.types.ocsp.OCSPResponse" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OCSPResponse</span>


<a href="#pki_tools.types.ocsp.OCSPResponse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="InitCryptoParser (pki_tools.types.crypto_parser.InitCryptoParser)" href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser">InitCryptoParser</a></code></p>


        <p>Represents an OCSP response.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>response_status</code></b>
                  (<code><a class="autorefs autorefs-internal" title="OcspResponseStatus (pki_tools.types.ocsp.OcspResponseStatus)" href="#pki_tools.types.ocsp.OcspResponseStatus">OcspResponseStatus</a></code>)
              –
              <div class="doc-md-description">
                <p>The OCSP response status.</p>
              </div>
            </li>
            <li>
              <b><code>certificate_status</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="OcspCertificateStatus (pki_tools.types.ocsp.OcspCertificateStatus)" href="#pki_tools.types.ocsp.OcspCertificateStatus">OcspCertificateStatus</a>]</code>)
              –
              <div class="doc-md-description">
                <p>The OCSP certificate status.</p>
              </div>
            </li>
            <li>
              <b><code>issuer_key_hash</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The issuer key hash.</p>
              </div>
            </li>
            <li>
              <b><code>revocation_time</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The revocation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <h5 id="pki_tools.types.ocsp.OCSPResponse--examples">Examples<a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse--examples" title="Permanent link">&para;</a></h5>
<h6 id="pki_tools.types.ocsp.OCSPResponse--create-ocsp-response">Create OCSP Response<a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse--create-ocsp-response" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>cert</code></summary>
<pre><code>import datetime

from pki_tools import SHA512, Validity, Name, Certificate, RSAKeyPair

cert_key_pair = RSAKeyPair.generate()
cert = Certificate(
    subject=Name(cn=[&quot;Cert CN&quot;]),
    issuer=Name(cn=[&quot;Cert CN&quot;]),
    validity=Validity(
        not_before=datetime.datetime.today() - datetime.timedelta(days=1),
        not_after=datetime.datetime.today() + datetime.timedelta(days=1),
    ),
)

cert.sign(cert_key_pair, SHA512)
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPResponse, OcspResponseStatus, OcspCertificateStatus

res = OCSPResponse(
    response_status=OcspResponseStatus.SUCCESSFUL,
    certificate_status=OcspCertificateStatus.REVOKED,
    issuer_key_hash=&quot;ISSUER_HASH&quot;,
    revocation_time=datetime.datetime.now(),
)

res.sign(cert, cert, SHA512, cert_key_pair.private_key, SHA512)

print(res)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Certificate Status: REVOKED
Issuer Key Hash: ISSUER_HASH
Response Status: SUCCESSFUL
Revocation Time: 2024-03-20 23:44:07.812235


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPResponse--initcryptoparserfrom_file"><a class="autorefs autorefs-internal" title="from_file


  
      classmethod
  " href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.from_file">InitCryptoParser.from_file</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse--initcryptoparserfrom_file" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>res.pem</code></summary>
<pre><code>-----BEGIN OCSP RESPONSE-----
MIICSAoBAKCCAkEwggI9BgkrBgEFBQcwAQEEggIuMIICKjCCARKiFgQU6+kUZ57c
x5S+dU8cqKswIZDbKxEYDzIwMjQwMzIwMjI1MTM4WjCB5jCB4zCBqTANBglghkgB
ZQMEAgMFAARAev9c8Ux9YW3pyXTHIp7Jb2rHaMP9VTyzalXWg7g+4HrIM07+qTFN
T1XNTsLb7p3DPmnwzV51hFoIgKBV0g3xUARA2cPkzXTAr1F/PS0zGg7IN962VaJn
IdqD9S4BzGCqMXqUwRC3ze8G/KMIpUHsx7r93vxS2GIJA7bisc/jdZ+LJwIUUYcX
KtFyhNcL/COZA2Hu+ur4u/ChERgPMjAyNDAzMjAyMzUxMzhaGA8yMDI0MDMyMDIz
NTEzOFqgERgPMjAyNDAzMjAyMzUxMzhaMA0GCSqGSIb3DQEBDQUAA4IBAQAoNRSK
vPnJEB8++zC1FsfMByUAUUVDKjLjkH2ObhPtcgtd4kBVtRYhpQnLu4vS/lImhRdh
99N13uoKgfdOs7GPQjkuWLiCwirmYeHjYJ4TNzQ3wkVdpLtCQPfkx5WtU5IcD8lM
aOOi+PN/rXuFo/sM0E3RV0PWu+X0zL6x1jYnVfXwc0HFHjmcALM498v2Qoet4On5
kW/Lh6+i6EUTzNWiVZ2evN7XSExqsvaXNxShAkGN1AH6M3a6DTVhDoF/948C3B/G
j40SrfyIpgfKiShWP5jUS9o5U1Vk54R6PJ22mmI1ZJZGfEj9pqbcfNgUnlC7UdML
1X93HfFsCrnOMcAh
-----END OCSP RESPONSE-----
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPResponse

req = OCSPResponse.from_file(&quot;res.pem&quot;)

print(req)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Certificate Status: REVOKED
Issuer Key Hash: |-
  D9C3E4CD74C0AF517F3D2D331A0EC837DEB655A26721DA83F52E01CC60AA317A94C110B7CDEF06FC
  A308A541ECC7BAFDDEFC52D8620903B6E2B1CFE3759F8B27
Response Status: SUCCESSFUL
Revocation Time: 2024-03-20 23:51:38+00:00


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPResponse--initcryptoparserfrom_pem_string"><a class="autorefs autorefs-internal" title="from_pem_string


  
      classmethod
  " href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.from_pem_string">InitCryptoParser.from_pem_string</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse--initcryptoparserfrom_pem_string" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>pem</code></summary>
<pre><code>pem = &quot;&quot;&quot;
-----BEGIN OCSP RESPONSE-----
MIICSAoBAKCCAkEwggI9BgkrBgEFBQcwAQEEggIuMIICKjCCARKiFgQU6+kUZ57c
x5S+dU8cqKswIZDbKxEYDzIwMjQwMzIwMjI1MTM4WjCB5jCB4zCBqTANBglghkgB
ZQMEAgMFAARAev9c8Ux9YW3pyXTHIp7Jb2rHaMP9VTyzalXWg7g+4HrIM07+qTFN
T1XNTsLb7p3DPmnwzV51hFoIgKBV0g3xUARA2cPkzXTAr1F/PS0zGg7IN962VaJn
IdqD9S4BzGCqMXqUwRC3ze8G/KMIpUHsx7r93vxS2GIJA7bisc/jdZ+LJwIUUYcX
KtFyhNcL/COZA2Hu+ur4u/ChERgPMjAyNDAzMjAyMzUxMzhaGA8yMDI0MDMyMDIz
NTEzOFqgERgPMjAyNDAzMjAyMzUxMzhaMA0GCSqGSIb3DQEBDQUAA4IBAQAoNRSK
vPnJEB8++zC1FsfMByUAUUVDKjLjkH2ObhPtcgtd4kBVtRYhpQnLu4vS/lImhRdh
99N13uoKgfdOs7GPQjkuWLiCwirmYeHjYJ4TNzQ3wkVdpLtCQPfkx5WtU5IcD8lM
aOOi+PN/rXuFo/sM0E3RV0PWu+X0zL6x1jYnVfXwc0HFHjmcALM498v2Qoet4On5
kW/Lh6+i6EUTzNWiVZ2evN7XSExqsvaXNxShAkGN1AH6M3a6DTVhDoF/948C3B/G
j40SrfyIpgfKiShWP5jUS9o5U1Vk54R6PJ22mmI1ZJZGfEj9pqbcfNgUnlC7UdML
1X93HfFsCrnOMcAh
-----END OCSP RESPONSE-----
&quot;&quot;&quot;
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPResponse

req = OCSPResponse.from_pem_string(pem)

print(req)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Certificate Status: REVOKED
Issuer Key Hash: |-
  D9C3E4CD74C0AF517F3D2D331A0EC837DEB655A26721DA83F52E01CC60AA317A94C110B7CDEF06FC
  A308A541ECC7BAFDDEFC52D8620903B6E2B1CFE3759F8B27
Response Status: SUCCESSFUL
Revocation Time: 2024-03-20 23:51:38+00:00


</code></pre>
</details>
<h6 id="pki_tools.types.ocsp.OCSPResponse--initcryptoparserto_file"><a class="autorefs autorefs-internal" title="to_file" href="../crypto_parser/#pki_tools.types.crypto_parser.InitCryptoParser.to_file">InitCryptoParser.to_file</a><a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse--initcryptoparserto_file" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>pem</code></summary>
<pre><code>pem = &quot;&quot;&quot;
-----BEGIN OCSP RESPONSE-----
MIICSAoBAKCCAkEwggI9BgkrBgEFBQcwAQEEggIuMIICKjCCARKiFgQU6+kUZ57c
x5S+dU8cqKswIZDbKxEYDzIwMjQwMzIwMjI1MTM4WjCB5jCB4zCBqTANBglghkgB
ZQMEAgMFAARAev9c8Ux9YW3pyXTHIp7Jb2rHaMP9VTyzalXWg7g+4HrIM07+qTFN
T1XNTsLb7p3DPmnwzV51hFoIgKBV0g3xUARA2cPkzXTAr1F/PS0zGg7IN962VaJn
IdqD9S4BzGCqMXqUwRC3ze8G/KMIpUHsx7r93vxS2GIJA7bisc/jdZ+LJwIUUYcX
KtFyhNcL/COZA2Hu+ur4u/ChERgPMjAyNDAzMjAyMzUxMzhaGA8yMDI0MDMyMDIz
NTEzOFqgERgPMjAyNDAzMjAyMzUxMzhaMA0GCSqGSIb3DQEBDQUAA4IBAQAoNRSK
vPnJEB8++zC1FsfMByUAUUVDKjLjkH2ObhPtcgtd4kBVtRYhpQnLu4vS/lImhRdh
99N13uoKgfdOs7GPQjkuWLiCwirmYeHjYJ4TNzQ3wkVdpLtCQPfkx5WtU5IcD8lM
aOOi+PN/rXuFo/sM0E3RV0PWu+X0zL6x1jYnVfXwc0HFHjmcALM498v2Qoet4On5
kW/Lh6+i6EUTzNWiVZ2evN7XSExqsvaXNxShAkGN1AH6M3a6DTVhDoF/948C3B/G
j40SrfyIpgfKiShWP5jUS9o5U1Vk54R6PJ22mmI1ZJZGfEj9pqbcfNgUnlC7UdML
1X93HfFsCrnOMcAh
-----END OCSP RESPONSE-----
&quot;&quot;&quot;
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPResponse

req = OCSPResponse.from_pem_string(pem)

req.to_file(&quot;out_res.pem&quot;)

</code></pre>
<details class="note">
<summary><code>out_res.pem</code></summary>
<pre><code>-----BEGIN OCSP RESPONSE-----
MIICSAoBAKCCAkEwggI9BgkrBgEFBQcwAQEEggIuMIICKjCCARKiFgQU6+kUZ57c
x5S+dU8cqKswIZDbKxEYDzIwMjQwMzIwMjI1MTM4WjCB5jCB4zCBqTANBglghkgB
ZQMEAgMFAARAev9c8Ux9YW3pyXTHIp7Jb2rHaMP9VTyzalXWg7g+4HrIM07+qTFN
T1XNTsLb7p3DPmnwzV51hFoIgKBV0g3xUARA2cPkzXTAr1F/PS0zGg7IN962VaJn
IdqD9S4BzGCqMXqUwRC3ze8G/KMIpUHsx7r93vxS2GIJA7bisc/jdZ+LJwIUUYcX
KtFyhNcL/COZA2Hu+ur4u/ChERgPMjAyNDAzMjAyMzUxMzhaGA8yMDI0MDMyMDIz
NTEzOFqgERgPMjAyNDAzMjAyMzUxMzhaMA0GCSqGSIb3DQEBDQUAA4IBAQAoNRSK
vPnJEB8++zC1FsfMByUAUUVDKjLjkH2ObhPtcgtd4kBVtRYhpQnLu4vS/lImhRdh
99N13uoKgfdOs7GPQjkuWLiCwirmYeHjYJ4TNzQ3wkVdpLtCQPfkx5WtU5IcD8lM
aOOi+PN/rXuFo/sM0E3RV0PWu+X0zL6x1jYnVfXwc0HFHjmcALM498v2Qoet4On5
kW/Lh6+i6EUTzNWiVZ2evN7XSExqsvaXNxShAkGN1AH6M3a6DTVhDoF/948C3B/G
j40SrfyIpgfKiShWP5jUS9o5U1Vk54R6PJ22mmI1ZJZGfEj9pqbcfNgUnlC7UdML
1X93HfFsCrnOMcAh
-----END OCSP RESPONSE-----

</code></pre>
</details>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPResponse.is_revoked" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">is_revoked</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPResponse.is_revoked" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">is_revoked: <span title="bool">bool</span></code></pre>

    <div class="doc doc-contents ">

        <p>Checks if the certificate is revoked.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="bool">bool</span></code>
              –
              <div class="doc-md-description">
                <p>True if the certificate is revoked, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPResponse.is_successful" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">is_successful</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPResponse.is_successful" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">is_successful: <span title="bool">bool</span></code></pre>

    <div class="doc doc-contents ">

        <p>Checks if the OCSP response is successful.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="bool">bool</span></code>
              –
              <div class="doc-md-description">
                <p>True if the response is successful, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPResponse.pem_bytes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">pem_bytes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPResponse.pem_bytes" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">pem_bytes: <span title="bytes">bytes</span></code></pre>

    <div class="doc doc-contents ">

        <p>Returns the PEM bytes of the object</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="bytes">bytes</span></code>
              –
              <div class="doc-md-description">
                <p>The PEM bytes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="pki_tools.types.ocsp.OCSPResponse.tbs_bytes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">tbs_bytes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPResponse.tbs_bytes" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">tbs_bytes: <span title="bytes">bytes</span></code></pre>

    <div class="doc doc-contents ">

        <p>Returns the bytes to be singed of the OCSP response.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>bytes</code></b>(                  <code><span title="bytes">bytes</span></code>
)              –
              <div class="doc-md-description">
                <p>The TBS bytes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="pki_tools.types.ocsp.OCSPResponse.from_cryptography" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_cryptography</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pki_tools.types.ocsp.OCSPResponse.from_cryptography" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">from_cryptography(crypto_ocsp_response: <span title="cryptography.x509.ocsp">ocsp</span>.<a class="autorefs autorefs-external" title="cryptography.x509.ocsp.OCSPResponse" href="https://cryptography.io/en/latest/x509/ocsp/#cryptography.x509.ocsp.OCSPResponse">OCSPResponse</a>) -&gt; <a class="autorefs autorefs-internal" title="OCSPResponse (pki_tools.types.ocsp.OCSPResponse)" href="#pki_tools.types.ocsp.OCSPResponse">OCSPResponse</a></code></pre>

    <div class="doc doc-contents ">

        <p>Constructs an OCSPResponse object from a cryptography
OCSPResponse object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>crypto_ocsp_response</code></b>
                  (<code><span title="cryptography.x509.ocsp">ocsp</span>.<a class="autorefs autorefs-external" title="cryptography.x509.ocsp.OCSPResponse" href="https://cryptography.io/en/latest/x509/ocsp/#cryptography.x509.ocsp.OCSPResponse">OCSPResponse</a></code>)
              –
              <div class="doc-md-description">
                <p>The cryptography OCSPResponse object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>OCSPResponse</code></b>(                  <code><a class="autorefs autorefs-internal" title="OCSPResponse (pki_tools.types.ocsp.OCSPResponse)" href="#pki_tools.types.ocsp.OCSPResponse">OCSPResponse</a></code>
)              –
              <div class="doc-md-description">
                <p>The constructed OCSPResponse object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <h6 id="pki_tools.types.ocsp.OCSPResponse.from_cryptography--example">Example<a class="headerlink" href="#pki_tools.types.ocsp.OCSPResponse.from_cryptography--example" title="Permanent link">&para;</a></h6>
<details class="tip">
<summary><code>crypto_res</code></summary>
<pre><code>import datetime

from cryptography.hazmat.primitives import hashes, serialization
from cryptography.x509 import ocsp, load_pem_x509_certificate

cert_private_key = b&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAqrALl8McEXwwKIgIo9sHhGht+VCVExRnBmkEmAKTnRc9iZVV
Q+slFnobc2y5p3TlBtLEfXed5yzak1NhnzLkfDQYrtUk6X5RREcsOohHT7AxuW/i
K3FyZo5PXM5asFf/DQSH6lp/XJPq0g/seUAvDNxbhLbjx5wjGe+6sCsLB/OSbBRz
Vmflb8p1XwmYr4LthhPE3kkLfCENVQPLoJOdwMw2qlqG63Qdwvj+wq+smIAauZDO
DtxfzWZ82ftH3+qMseiveMPR2Szxz9qi2kSnsHTjdHRlEe5WzHOwa6U/HlPBOVHt
IANxm0PHo8Np47ajTG3BUif6C/XUE5Co/Dz5awIDAQABAoIBADYVKN8x2atqo6G8
FKzCglvAcRQdpdaRUOGVlfiKXHZafkuhTw6Bq9M25orIqPy3y7fBQbQVmik9K5ah
xV1ZlU8LfMSs0ZDQTvSo7okvVBUaWW8N1eZ5AEwhjGD2G4MjprNbu6sUeKV/Utiz
ZfS3UxEqoy7mej7tqKuXq5oVUV33mUwXiT+gx+X688iIlnSMt0XvwrVGfpDnGPqJ
DUnNOli6dUDhvmfvs7KH8H8MLPHu9hK1Uq8zm7sMGS3WHb4E0krjNFZtkByy5cvk
M4k1QpCl7Q4ym3lpOBoyXkFF/Mdi56Ufvo+75FwGqGamREoZect6TaMRvoDmpVcS
I9EemdECgYEA269jlNFz/0fBgZX0mPgaJS7KTiUsTQ/HBMEW7lYLEwCPgQBATR2M
mJAJtCdwWvyVu79cRu9ShqoK83tUVzsXYFu1lWE0m/r6qao7p9Pam9jLr6qmLngK
wsAX44LatM6duNg6BSD2EteTWArJYOOeRrZnkeb8KKjDelqKcYxHAFsCgYEAxucw
JAeQFxCoD+sgtfSapVulASyATTvTfFM6DyqcBMTsm5YU4lik2RuKV5T7hsRCsJGu
rSYnstOVkx9B1gHaLYrUF6MYwUcKfJTFhOwutrYqXi1Vsoq3gUrDleGFT5s3+iPR
VnHCjkJz/fDOdLgaCiLRBMoclFY1B2SLwzRWODECgYA9f0mXHVMlgUbQKdRBBiL7
ia+kVI+kOuhxkkQDEB8lgKCrchCOBdmX06qDvg6byd14o0cHrHMjs3JBWqLvkGEo
3kNkv8NkbsvAtyDgCFRIEFZkpJbEp2ILxo5pZ/YlazmHxy/mw6Ve/O4IVWyuLMnf
7avskgbAsw2VsMbUpnoxxQKBgHdhdTR60ZH2bli3kDeFq3gKLFwrAIramJGrRlKq
CWCXbUfo6Xn9KFwiuoLcqab2jux5U/UazIL5mXHnNdWj4Paqt6fEPWxsHjAt/utL
8rG5Xm6OGTyDI6bXX9LKu//OsudQrimLN/G4kvPcn53Qjdh9kySjxkmGAGgCghxU
gldRAoGAWqY4tm8+HjtU0iSnVm+SetjSPxeTeGe9HUU6oM8kalshKLHjs2SdLJAB
1Zc4hUoZuvfIfX63XdshcGZe8wD2P2+ZFxNwnS0XxpwfQto3sTZZWiy8VezPy+js
o4E3mb1jZDQvmXey9tE73hGG4RrBNeHsjywfUs5pKHEOOEqKgEQ=
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;
crypto_private_key = serialization.load_pem_private_key(
    cert_private_key, password=None
)

pem_cert = b&quot;&quot;&quot;
-----BEGIN CERTIFICATE-----
MIICsDCCAZigAwIBAgIUL/5wxBEYcnkrAfHje6sDrdv9knMwDQYJKoZIhvcNAQEN
BQAwEjEQMA4GA1UEAwwHQ2VydCBDTjAeFw0yNDAzMTkyMzQ1MzlaFw0yNDAzMjEy
MzQ1MzlaMBIxEDAOBgNVBAMMB0NlcnQgQ04wggEiMA0GCSqGSIb3DQEBAQUAA4IB
DwAwggEKAoIBAQCqsAuXwxwRfDAoiAij2weEaG35UJUTFGcGaQSYApOdFz2JlVVD
6yUWehtzbLmndOUG0sR9d53nLNqTU2GfMuR8NBiu1STpflFERyw6iEdPsDG5b+Ir
cXJmjk9czlqwV/8NBIfqWn9ck+rSD+x5QC8M3FuEtuPHnCMZ77qwKwsH85JsFHNW
Z+VvynVfCZivgu2GE8TeSQt8IQ1VA8ugk53AzDaqWobrdB3C+P7Cr6yYgBq5kM4O
3F/NZnzZ+0ff6oyx6K94w9HZLPHP2qLaRKewdON0dGUR7lbMc7BrpT8eU8E5Ue0g
A3GbQ8ejw2njtqNMbcFSJ/oL9dQTkKj8PPlrAgMBAAEwDQYJKoZIhvcNAQENBQAD
ggEBAKcfkel3elnmZN9vblXfc3nf6AkEpaRhAtjIkPLA9EY6vJCGm6ysjQinHlb+
oOsC+S+1c22Bc8z+b1K8GHkV8EZf9c70WmFTKwSB0JkyQ1xyx9jcPm0al0zxaXQX
XertQuzhObayPy8hMbV6Kwmihf0BrR4kwUQFWMAzZ98J5c/jY5UTvEhLN8ntt5k5
IwJofRuEMBmEtRkFR2Qt1K3GJv4Aid94hD+bBOBKZV8MTvRjrU64HOKA25/TEmyf
hIRtzvQkCh9z3S2/+zfYKsmDtENWD7dJLw2Ss9cqrJObeYcjjVvDgSQyt1csMtPr
6Y5Qqajflelt51pd55TqVc8d1Js=
-----END CERTIFICATE-----
&quot;&quot;&quot;
cert = load_pem_x509_certificate(pem_cert)

builder = ocsp.OCSPResponseBuilder()
builder = builder.add_response(
    cert=cert,
    issuer=cert,
    algorithm=hashes.SHA256(),
    cert_status=ocsp.OCSPCertStatus.GOOD,
    this_update=datetime.datetime.now(),
    next_update=datetime.datetime.now(),
    revocation_time=None,
    revocation_reason=None,
).responder_id(ocsp.OCSPResponderEncoding.HASH, cert)
crypto_res = builder.sign(crypto_private_key, hashes.SHA256())
</code></pre>
</details>
<pre><code class="language-python">from pki_tools import OCSPResponse

res = OCSPResponse.from_cryptography(crypto_res)

print(res)

</code></pre>
<details class="note">
<summary>Print output</summary>
<pre><code>Certificate Status: GOOD
Issuer Key Hash: 975ECC737818C143DD1110ED04BFD8FB76AF836F360D8F776FF44C19AF4C56FC
Response Status: SUCCESSFUL


</code></pre>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pki_tools.types.ocsp.OCSPResponse.hash_with_alg" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">hash_with_alg</span>


<a href="#pki_tools.types.ocsp.OCSPResponse.hash_with_alg" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">hash_with_alg(der_key: <span title="bytes">bytes</span>) -&gt; <span title="str">str</span></code></pre>

    <div class="doc doc-contents ">

        <p>Hashes a DER key bytes with the algorithm of the OCSP response.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>der_key</code></b>
                  (<code><span title="bytes">bytes</span></code>)
              –
              <div class="doc-md-description">
                <p>The DER key.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>str</code></b>(                  <code><span title="str">str</span></code>
)              –
              <div class="doc-md-description">
                <p>The hashed key.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="pki_tools.types.ocsp.OCSPResponse.sign" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sign</span>


<a href="#pki_tools.types.ocsp.OCSPResponse.sign" class="headerlink" title="Permanent link">&para;</a></h5>
<pre class="highlight"><code class="language-python doc-signature">sign(cert: <a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a>, issuer: <a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a>, response_algorithm: <a class="autorefs autorefs-internal" title="SignatureAlgorithm (pki_tools.types.signature_algorithm.SignatureAlgorithm)" href="../signature_algorithm/#pki_tools.types.signature_algorithm.SignatureAlgorithm">SignatureAlgorithm</a>, private_key: <a class="autorefs autorefs-internal" title="CryptoPrivateKey (pki_tools.types.key_pair.CryptoPrivateKey)" href="../key_pair/#pki_tools.types.key_pair.CryptoPrivateKey">CryptoPrivateKey</a>, signature_algorithm: <span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="SignatureAlgorithm (pki_tools.types.signature_algorithm.SignatureAlgorithm)" href="../signature_algorithm/#pki_tools.types.signature_algorithm.SignatureAlgorithm">SignatureAlgorithm</a>] = None)</code></pre>

    <div class="doc doc-contents ">

        <p>Signs the OCSP response.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>cert</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a></code>)
              –
              <div class="doc-md-description">
                <p>The certificate.</p>
              </div>
            </li>
            <li>
              <b><code>issuer</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Certificate (pki_tools.types.certificate.Certificate)" href="../certificate/#pki_tools.types.certificate.Certificate">Certificate</a></code>)
              –
              <div class="doc-md-description">
                <p>The issuer certificate.</p>
              </div>
            </li>
            <li>
              <b><code>response_algorithm</code></b>
                  (<code><a class="autorefs autorefs-internal" title="SignatureAlgorithm (pki_tools.types.signature_algorithm.SignatureAlgorithm)" href="../signature_algorithm/#pki_tools.types.signature_algorithm.SignatureAlgorithm">SignatureAlgorithm</a></code>)
              –
              <div class="doc-md-description">
                <p>The signature algorithm for the response.</p>
              </div>
            </li>
            <li>
              <b><code>private_key</code></b>
                  (<code><a class="autorefs autorefs-internal" title="CryptoPrivateKey (pki_tools.types.key_pair.CryptoPrivateKey)" href="../key_pair/#pki_tools.types.key_pair.CryptoPrivateKey">CryptoPrivateKey</a></code>)
              –
              <div class="doc-md-description">
                <p>The private key to sign the response.</p>
              </div>
            </li>
            <li>
              <b><code>signature_algorithm</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="SignatureAlgorithm (pki_tools.types.signature_algorithm.SignatureAlgorithm)" href="../signature_algorithm/#pki_tools.types.signature_algorithm.SignatureAlgorithm">SignatureAlgorithm</a>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The signature algorithm.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="pki_tools.types.ocsp.OcspCertificateStatus" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OcspCertificateStatus</span>


<a href="#pki_tools.types.ocsp.OcspCertificateStatus" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enumeration of OCSP certificate statuses.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="pki_tools.types.ocsp.OcspResponseStatus" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OcspResponseStatus</span>


<a href="#pki_tools.types.ocsp.OcspResponseStatus" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enumeration of OCSP response statuses.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../name/" class="btn btn-neutral float-left" title="Name"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../extensions/" class="btn btn-neutral float-right" title="Extensions">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/fulder/pki-tools" class="fa fa-code-fork" style="color: #fcfcfc"> fulder/pki-tools</a>
        </span>
    
    
      <span><a href="../name/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../extensions/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
